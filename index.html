 <!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Game Pesawat 2D Final</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #000;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        canvas {
            background-image: linear-gradient(to bottom, #0c0c1e, #1a1a38);
            display: block;
        }
        .ui-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            color: white;
            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 10;
        }
        .hidden { display: none; }
        .button {
            padding: 15px 30px;
            font-size: 1.5rem;
            background-color: #0097a7;
            color: white;
            border: 2px solid #00cde2;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 20px;
            font-weight: bold;
        }
        #controls-container {
            position: absolute;
            bottom: 20px;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            padding: 0 5%;
            box-sizing: border-box;
            z-index: 5;
            pointer-events: none;
        }
        .control-pad {
            pointer-events: auto;
            width: 120px;
            height: 120px;
            position: relative;
        }
        .control-btn {
            position: absolute;
            width: 50px;
            height: 50px;
            background-color: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: 50%;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            user-select: none;
        }
        .control-btn:active { background-color: rgba(255, 255, 255, 0.5); }
        #btn-up { top: 0; left: 35px; }
        #btn-down { bottom: 0; left: 35px; }
        #btn-left { top: 35px; left: 0; }
        #btn-right { top: 35px; right: 0; }
        #btn-fire {
            width: 80px;
            height: 80px;
            position: static;
        }
    </style>
</head>
<body>

    <canvas id="gameCanvas"></canvas>

    <!-- Audio Elements -->
    <audio id="music" loop>
        <source src="https://archive.org/download/4_20220902/4.mp3" type="audio/mpeg">
    </audio>
    <audio id="laser-sound">
        <source src="https://archive.org/download/laser-gun-sound-effect/laser-gun-sound-effect.mp3" type="audio/mpeg">
    </audio>

    <div id="start-screen" class="ui-overlay">
        <h1>PERANG BINTANG 2D</h1>
        <p>Gunakan tombol di layar atau Panah/WASD untuk bergerak & Spasi untuk menembak.</p>
        <p style="font-size: 0.8rem; margin-top: 10px;">(Game ini mengandung suara)</p>
        <button id="start-button" class="button">MULAI</button>
    </div>

    <div id="game-over-screen" class="ui-overlay hidden">
        <h1>GAME OVER</h1>
        <p id="final-score"></p>
        <button id="restart-button" class="button">MAIN LAGI</button>
    </div>

    <div id="controls-container" class="hidden">
        <div class="control-pad">
            <div id="btn-up" class="control-btn">â–²</div>
            <div id="btn-left" class="control-btn">â—„</div>
            <div id="btn-right" class="control-btn">â–º</div>
            <div id="btn-down" class="control-btn">â–¼</div>
        </div>
        <div class="control-pad" style="display: flex; justify-content: flex-end; align-items: center;">
            <div id="btn-fire" class="control-btn">ðŸ’¥</div>
        </div>
    </div>


<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    // UI & Audio Elements
    const startScreen = document.getElementById('start-screen');
    const gameOverScreen = document.getElementById('game-over-screen');
    const controlsContainer = document.getElementById('controls-container');
    const startButton = document.getElementById('start-button');
    const restartButton = document.getElementById('restart-button');
    const finalScoreElement = document.getElementById('final-score');
    const music = document.getElementById('music');
    const laserSound = document.getElementById('laser-sound');
    
    music.volume = 0.3; // Atur volume musik agar tidak terlalu keras
    laserSound.volume = 0.5;

    let isGameRunning = false;
    let score = 0;
    let stars = [];

    function setCanvasSize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }

    // --- Game Objects ---
    const player = { x: 0, y: 0, width: 50, height: 55, speed: 5, dx: 0, dy: 0 };
    let bullets = [];
    let enemies = [];

    // --- Drawing Functions ---
    function drawPlayer() {
        ctx.save();
        ctx.translate(player.x, player.y);
        
        // Body Pesawat (Utama)
        ctx.fillStyle = '#c0c0c0'; // Silver
        ctx.beginPath();
        ctx.moveTo(0, -25); // Hidung
        ctx.lineTo(20, 15); // Sayap kanan
        ctx.lineTo(20, 25); // Belakang kanan
        ctx.lineTo(-20, 25); // Belakang kiri
        ctx.lineTo(-20, 15); // Sayap kiri
        ctx.closePath();
        ctx.fill();

        // Kokpit
        ctx.fillStyle = '#00cde2'; // Cyan
        ctx.beginPath();
        ctx.moveTo(0, -15);
        ctx.lineTo(7, 0);
        ctx.lineTo(-7, 0);
        ctx.closePath();
        ctx.fill();
        
        // Ekor
        ctx.fillStyle = '#a0a0a0';
        ctx.fillRect(-5, 25, 10, 5);

        ctx.restore();
    }

    function drawBullet(bullet) {
        ctx.fillStyle = '#ffff00'; // Kuning
        ctx.beginPath();
        ctx.arc(bullet.x, bullet.y, bullet.width, 0, Math.PI * 2);
        ctx.fill();
    }

    function drawEnemy(enemy) {
        ctx.fillStyle = '#ff5555';
        ctx.fillRect(enemy.x - enemy.width / 2, enemy.y, enemy.width, enemy.height);
        ctx.fillStyle = '#ff8888';
        ctx.fillRect(enemy.x - enemy.width / 2 + 5, enemy.y + 5, enemy.width - 10, enemy.height - 10);
    }
    
    function createStars() {
        stars = [];
        for (let i = 0; i < 200; i++) {
            stars.push({ x: Math.random() * canvas.width, y: Math.random() * canvas.height, radius: Math.random() * 1.5 });
        }
    }

    function drawStars() {
        stars.forEach(star => {
            star.y += 0.2;
            if (star.y > canvas.height) {
                star.y = 0;
                star.x = Math.random() * canvas.width;
            }
            ctx.beginPath();
            ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
            ctx.fillStyle = `rgba(255, 255, 255, 0.8)`;
            ctx.fill();
        });
    }

    // --- Game Logic ---
    function update() {
        if (!isGameRunning) return;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        drawStars();
        player.x += player.dx;
        player.y += player.dy;

        if (player.x - player.width / 2 < 0) player.x = player.width / 2;
        if (player.x + player.width / 2 > canvas.width) player.x = canvas.width - player.width / 2;
        if (player.y - player.height / 2 < 0) player.y = player.height / 2;
        if (player.y + player.height / 2 > canvas.height) player.y = canvas.height - player.height / 2;
        
        drawPlayer();

        bullets.forEach((bullet, bIndex) => {
            bullet.y -= bullet.speed;
            drawBullet(bullet);
            if (bullet.y < 0) bullets.splice(bIndex, 1);
        });

        enemies.forEach((enemy, eIndex) => {
            enemy.y += enemy.speed;
            drawEnemy(enemy);
            if (enemy.y > canvas.height) enemies.splice(eIndex, 1);
        });

        checkCollisions();

        ctx.fillStyle = 'white';
        ctx.font = '24px Arial';
        ctx.fillText(`Skor: ${score}`, 20, 40);

        requestAnimationFrame(update);
    }
    
    function checkCollisions() {
        enemies.forEach((enemy, eIndex) => {
            bullets.forEach((bullet, bIndex) => {
                if (bullet.x > enemy.x - enemy.width / 2 && bullet.x < enemy.x + enemy.width / 2 &&
                    bullet.y > enemy.y && bullet.y < enemy.y + enemy.height) {
                    enemies.splice(eIndex, 1);
                    bullets.splice(bIndex, 1);
                    score += 10;
                }
            });

            if (player.x - player.width / 2 < enemy.x + enemy.width / 2 &&
                player.x + player.width / 2 > enemy.x - enemy.width / 2 &&
                player.y - player.height / 2 < enemy.y + enemy.height &&
                player.y + player.height / 2 > enemy.y) {
                endGame();
            }
        });
    }

    function spawnEnemy() {
        if (!isGameRunning) return;
        const size = Math.random() * 20 + 30;
        enemies.push({
            x: Math.random() * (canvas.width - size) + size / 2,
            y: -size,
            width: size,
            height: size,
            speed: Math.random() * 2 + 1
        });
    }

    // --- Game State Functions ---
    let enemyInterval;

    function startGame() {
        isGameRunning = true;
        score = 0;
        player.x = canvas.width / 2;
        player.y = canvas.height - 60;
        enemies = [];
        bullets = [];

        startScreen.classList.add('hidden');
        gameOverScreen.classList.add('hidden');
        controlsContainer.classList.remove('hidden');

        music.currentTime = 0;
        music.play();

        enemyInterval = setInterval(spawnEnemy, 1500);
        update();
    }

    function endGame() {
        isGameRunning = false;
        clearInterval(enemyInterval);
        music.pause();
        finalScoreElement.innerText = `Skor Akhir: ${score}`;
        gameOverScreen.classList.remove('hidden');
        controlsContainer.classList.add('hidden');
    }

    // --- Input Handling ---
    const controls = {
        'btn-up': { dy: -player.speed }, 'btn-down': { dy: player.speed },
        'btn-left': { dx: -player.speed }, 'btn-right': { dx: player.speed }
    };

    function handleControlPress(id, isPressed) {
        const move = controls[id];
        if (move.dx !== undefined) player.dx = isPressed ? move.dx : 0;
        if (move.dy !== undefined) player.dy = isPressed ? move.dy : 0;
    }

    Object.keys(controls).forEach(id => {
        const element = document.getElementById(id);
        const press = (e) => { e.preventDefault(); handleControlPress(id, true); };
        const release = (e) => { e.preventDefault(); handleControlPress(id, false); };
        element.addEventListener('mousedown', press);
        element.addEventListener('mouseup', release);
        element.addEventListener('mouseleave', release);
        element.addEventListener('touchstart', press, { passive: false });
        element.addEventListener('touchend', release);
    });
    
    function shoot() {
        if (!isGameRunning) return;
        const sound = laserSound.cloneNode();
        sound.play();
        bullets.push({ x: player.x, y: player.y - player.height / 2, width: 5, speed: 7 });
    }

    document.getElementById('btn-fire').addEventListener('mousedown', shoot);
    document.getElementById('btn-fire').addEventListener('touchstart', (e) => { e.preventDefault(); shoot(); }, { passive: false });
    
    window.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowUp' || e.key === 'w') player.dy = -player.speed;
        if (e.key === 'ArrowDown' || e.key === 's') player.dy = player.speed;
        if (e.key === 'ArrowLeft' || e.key === 'a') player.dx = -player.speed;
        if (e.key === 'ArrowRight' || e.key === 'd') player.dx = player.speed;
        if (e.key === ' ') shoot();
    });
    
    window.addEventListener('keyup', (e) => {
        if (['ArrowUp', 'w', 'ArrowDown', 's'].includes(e.key)) player.dy = 0;
        if (['ArrowLeft', 'a', 'ArrowRight', 'd'].includes(e.key)) player.dx = 0;
    });

    // --- Initialization ---
    window.addEventListener('resize', () => { setCanvasSize(); createStars(); });
    startButton.addEventListener('click', startGame);
    restartButton.addEventListener('click', startGame);
    setCanvasSize();
    createStars();
    drawStars();
</script>

</body>
</html>

